<!--ìƒí’ˆ ëª©ë¡-->

<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/category-layout}">
<body>
<div layout:fragment="content">
  <!-- Start Filter Bar -->
  <div class="filter-bar d-flex flex-wrap align-items-center">
    <div class="sorting">
      <label>
        <select>
          <option value="1">Default sorting</option>
          <option value="1">Default sorting</option>
          <option value="1">Default sorting</option>
        </select>
      </label>
    </div>
    <div class="sorting mr-auto">
    </div>
    <div>
      <div class="input-group filter-bar-search">
        <input type="text" placeholder="Search">
        <div class="input-group-append">
          <button type="button"><i class="ti-search"></i></button>
        </div>
      </div>
    </div>
  </div>
  <!-- End Filter Bar -->


  <!-- ìƒí’ˆ ë¦¬ìŠ¤íŠ¸ ì¶œë ¥ -->
  <section class="lattest-product-area pb-40 category-list">
    <div class="row">
      <div th:each="product : ${products}" class="col-md-6 col-lg-4">
        <div class="card text-center card-product">
          <div class="card-product__img">
            <!-- ë„ì„œ ì´ë¯¸ì§€: productImagePathsëŠ” Listì´ë¯€ë¡œ ì²« ë²ˆì§¸ ì´ë¯¸ì§€ë¥¼ ì‚¬ìš© -->
            <div class="card-img"
                 th:if="${product.productImagePaths != null and !#lists.isEmpty(product.productImagePaths)}">
              <img th:src="${product.productImagePaths[0].productImagePath}"
                   alt="ëŒ€í‘œ ì´ë¯¸ì§€"
                   onerror="this.src='https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRIU-UceDHDzvuE5Gp1xYX0irHtgIWTeWwzlPVvLegZoes3vFaKT736CE8&s'">
              <ul class="card-product__imgOverlay">
                <li><button><i class="ti-search"></i></button></li>
                <li><button><i class="ti-shopping-cart"></i></button></li>
                <li><button><i class="ti-heart"></i></button></li>
              </ul>
              <div>
              </div>
            </div>
          </div>
        </div>
        <div class="card-body">
          <!-- ë„ì„œ ì œëª© -->
          <h5 th:text="${product.productTitle}" class="card-product__title">ë„ì„œ ì œëª©</h5>
          <p>ì¶œíŒì‚¬: <span th:text="${product.publisher != null ? product.publisher.publisherName : 'ì¶œíŒì‚¬ ì •ë³´ ì—†ìŒ'}">ì¶œíŒì‚¬</span></p>
          <!-- íŒë§¤ ê°€ê²© -->
          <span class="card-product__price">íŒë§¤ê°€: <span th:text="${product.productSalePrice}">0</span>ì›</span>
        </div>
      </div>
    </div>
  </section>


  <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
  <nav th:if="${products.totalPages > 1}">
    <ul class="pagination justify-content-center">
      <li class="page-item" th:classappend="${!products.hasPrevious()} ? 'disabled'">
        <a class="page-link"
           th:href="@{/category/{categoryId}(categoryId=${categoryId}, query=${param.query}, queryType=${param.queryType}, page=0, size=${products.size})}">ì²˜ìŒ</a>
      </li>

      <li class="page-item"
          th:each="i : ${#numbers.sequence(0, products.totalPages - 1)}"
          th:classappend="${i == products.number} ? 'active'">
        <a class="page-link"
           th:href="@{/category/{categoryId}(categoryId=${categoryId}, query=${param.query}, queryType=${param.queryType}, page=${i}, size=${products.size})}"
           th:text="${i + 1}">1</a>
      </li>

      <li class="page-item" th:classappend="${!products.hasNext()} ? 'disabled'">
        <a class="page-link"
           th:href="@{/category/{categoryId}(categoryId=${categoryId}, query=${param.query}, queryType=${param.queryType}, page=${products.totalPages - 1}, size=${products.size})}">ë§ˆì§€ë§‰</a>
      </li>
    </ul>
  </nav>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const sidebar = document.querySelector(".sidebar-filter");
      const toggles = sidebar.querySelectorAll(".toggle");

      toggles.forEach(span => {
        const li = span.closest("li");
        const childUl = li.querySelector(":scope > ul");

        if (!childUl) {
          span.textContent = "ğŸ”¹";
          span.style.cursor = "default";
          span.onclick = null;
        } else {
          span.textContent = "ğŸ“";
          childUl.classList.add("d-none");
        }
      });
    });

    function toggleClick(element) {
      const li = element.closest("li");
      const childUl = li.querySelector(":scope > ul");

      if (childUl) {
        const isOpen = !childUl.classList.contains("d-none");
        childUl.classList.toggle("d-none");
        element.textContent = isOpen ? "ğŸ“" : "ğŸ“‚";
      }
    }
  </script>
</div>
</body>
</html>